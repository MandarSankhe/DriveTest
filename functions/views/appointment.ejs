<!DOCTYPE html>
<html lang="en">
  <%- include('layouts/header'); -%>

  <body class="d-flex flex-column">
    <main class="flex-shrink-0">
      <!-- Navigation-->
      <%- include('layouts/navbar'); -%>
      <!-- Page content-->
      <section class="py-5">
        <div class="container px-5">
          <!-- Contact form-->
          <div class="row">
            <div class="col-md-12 bg-light rounded-3 py-5 px-4 px-md-5 mb-5">
              <div class="text-center mb-5">
                <div
                  class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
                >
                  <i class="bi bi-person-square"></i>
                </div>
                <h1 class="fw-bolder">Appointment Details</h1>
                <p class="lead fw-normal text-muted mb-0">
                  Make appointment slots for users
                </p>
              </div>

              <div class="row gx-5 justify-content-center">
                <div class="col-lg-8 col-xl-6">
                  <!-- Errors-->
                  <% if(errors !=null && errors.length> 0){ %>
                  <ul class="list-group"></ul>
                  <% errors.forEach(error=> { %>
                  <li class="list-group-item list-group-item-danger">
                    <%= error %>
                  </li>
                  <% }) %> <% } %>
                  <form
                    id="appointmentForm"
                    method="post"
                    enctype="application/x-www-form-urlencoded"
                    action="/addSlot"
                  >
                    <!-- Date input-->
                    <div class="form-floating mb-3">
                      <input
                        class="form-control"
                        name="date"
                        id="date"
                        type="date"
                        placeholder="Enter the date.."
                        onchange="updateAvailableTimes()"
                        value="<%= date %>"
                        required
                      />
                      <label for="date">Date</label>
                    </div>
                    <!-- Time input-->
                    <div class="form-floating mb-3">
                      <div class="form-group">
                        <label for="time"><b>Select Timeslots to add:</b></label
                        ><br /><br />
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          <%=bookedTimes.includes("9:00") ? "disabled" : "" %>
                          name="time" value="9:00">
                          <label class="form-check-label">9:00 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="9:30"
                          <%=bookedTimes.includes("9:30") ? "disabled" : "" %>>
                          <label class="form-check-label">9:30 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="10:00"
                          <%=bookedTimes.includes("10:00") ? "disabled" : "" %>>
                          <label class="form-check-label">10:00 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="10:30"
                          <%=bookedTimes.includes("10:30") ? "disabled" : "" %>>
                          <label class="form-check-label">10:30 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="11:00"
                          <%=bookedTimes.includes("11:00") ? "disabled" : "" %>>
                          <label class="form-check-label">11:00 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="11:30"
                          <%=bookedTimes.includes("11:30") ? "disabled" : "" %>>
                          <label class="form-check-label">11:30 AM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="12:00"
                          <%=bookedTimes.includes("12:00") ? "disabled" : "" %>>
                          <label class="form-check-label">12:00 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="12:30"
                          <%=bookedTimes.includes("12:30") ? "disabled" : "" %>>
                          <label class="form-check-label">12:30 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="13:00"
                          <%=bookedTimes.includes("13:00") ? "disabled" : "" %>>
                          <label class="form-check-label">01:00 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="13:30"
                          <%=bookedTimes.includes("13:30") ? "disabled" : "" %>>
                          <label class="form-check-label">01:30 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="14:00"
                          <%=bookedTimes.includes("14:00") ? "disabled" : "" %>>
                          <label class="form-check-label">02:00 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="14:30"
                          <%=bookedTimes.includes("14:30") ? "disabled" : "" %>>
                          <label class="form-check-label">02:30 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="15:00"
                          <%=bookedTimes.includes("15:00") ? "disabled" : "" %>>
                          <label class="form-check-label">03:00 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="15:30"
                          <%=bookedTimes.includes("15:30") ? "disabled" : "" %>>
                          <label class="form-check-label">03:30 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="16:00"
                          <%=bookedTimes.includes("16:00") ? "disabled" : "" %>>
                          <label class="form-check-label">04:00 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="16:30"
                          <%=bookedTimes.includes("16:30") ? "disabled" : "" %>>
                          <label class="form-check-label">04:30 PM</label>
                        </div>
                        <div class="form-check-inline">
                          <input class="form-check-input" type="checkbox"
                          name="time" value="17:00"
                          <%=bookedTimes.includes("17:00") ? "disabled" : "" %>>
                          <label class="form-check-label">05:00 PM</label>
                        </div>
                      </div>
                    </div>
                    <div class="d-grid">
                      <button
                        class="btn btn-primary btn-lg"
                        id="submitButton"
                        type="submit"
                      >
                        Submit
                      </button>
                    </div>
                  </form>

                  <!-- Hidden form to handle checkbox disable to 
                                                         prevent duplication at frontend level-->
                  <form
                    id="updateForm"
                    method="post"
                    action="/updateTimesCheckbox"
                  >
                    <input type="hidden" name="date" id="hiddenDate" />
                    <input type="hidden" name="data" id="hiddenData" />
                  </form>
                </div>
              </div>
            </div>
          </div>

          <!-- Page content -->
          <section class="py-5">
            <div class="container px-5">
              <h1 class="fw-bolder">User Status</h1>
              <p class="lead fw-normal text-muted mb-0">
                List of passed and failed users
              </p>

              <div class="row">
                <!-- Table for Passed Users -->
                <div class="col-md-6">
                  <h2>Passed Users</h2>
                  <table class="table">
                    <thead class="bg-success text-white">
                      <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Test Type</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% passedUsers?.forEach(user => { %>
                      <tr data-user-id="<%= user._id %>">
                        <td><%= user.firstName %></td>
                        <td><%= user.lastName %></td>
                        <td><%= user.TestType %></td>
                      </tr>
                      <% }); %>
                    </tbody>
                  </table>
                </div>

                <!-- Table for Failed Users -->
                <div class="col-md-6">
                  <h2>Failed Users</h2>
                  <table class="table">
                    <thead class="bg-danger text-white">
                      <tr>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Test Type</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% failedUsers.forEach(user => { %>
                      <tr data-user-id="<%= user._id %>">
                        <td><%= user.firstName %></td>
                        <td><%= user.lastName %></td>
                        <td><%= user.TestType %></td>
                      </tr>
                      <% }); %>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </section>
          <br /><br />

          <!-- Contact cards-->
          <div class="row gx-5 row-cols-2 row-cols-lg-4 py-5">
            <div class="col">
              <div
                class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
              >
                <i class="bi bi-chat-dots"></i>
              </div>
              <div class="h5 mb-2">Chat with us</div>
              <p class="text-muted mb-0">
                Chat live with one of our support specialists.
              </p>
            </div>
            <div class="col">
              <div
                class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
              >
                <i class="bi bi-people"></i>
              </div>
              <div class="h5">Ask the community</div>
              <p class="text-muted mb-0">
                Explore our community forums and communicate with other users.
              </p>
            </div>
            <div class="col">
              <div
                class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
              >
                <i class="bi bi-question-circle"></i>
              </div>
              <div class="h5">Support center</div>
              <p class="text-muted mb-0">
                Browse FAQ's and support articles to find solutions.
              </p>
            </div>
            <div class="col">
              <div
                class="feature bg-primary bg-gradient text-white rounded-3 mb-3"
              >
                <i class="bi bi-telephone"></i>
              </div>
              <div class="h5">Call us</div>
              <p class="text-muted mb-0">
                Call us during normal business hours at (555) 892-9403.
              </p>
            </div>
          </div>
        </div>
      </section>
    </main>
    <!-- Footer-->

    <%- include('layouts/footer'); -%>
  </body>
</html>
